<!-- 
Author: Hayden Hamwood <mailto:hayden.hamwood@monash.edu>
Latest Update: 04/10/2018

04/10/2018
Changed Separate INC and REQ fields to now search through Remedy Smart IT
Need to use full INC or REQ to get best results.
-->

<!DOCTYPE html>
<title>Remedy Helper</title>
<body style="background-color:#F2F2F2">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--<link rel="stylesheet" href="w3.css">-->

<style type="text/css">
    .Table
    {
        display: table;
    }
    .Title
    {
        display: table-caption;
        text-align: left;
        font-weight: bold;
        font-size: larger;
    }
    .Heading
    {
        display: table-row;
        font-weight: bold;
        text-align: left;
    }
    .Row
    {
        display: table-row;
    }
    .Cell
    {
        display: table-cell;
        border: none;
        border-width: thin;
        padding-left: 5px;
        padding-right: 5px;
    }
	.sansserif 
	{
    font-family: "Trebuchet MS", Geneva, sans-serif;
	}
	
</style>

<script> 
function toggle() {
	var ele = document.getElementById("toggleText");
	var text = document.getElementById("displayText");
	if(ele.style.display == "block") {
    		ele.style.display = "none";
		text.innerHTML = "Show";
  	}
	else {
		ele.style.display = "block";
		text.innerHTML = "Hide";
	}
} 
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70612214-1', 'auto');
  ga('send', 'pageview');
</script>

    <div style="display: block;background-color:#F2F2F2">
    <button class="sansserif" id="displayText" onclick="javascript:toggle();">Hide</button>
    <button onclick="RemedyHome()">Ticket Console</button>
    <button onclick="window.open('#')" formtarget="_blank">New Tab</button>
    </div>

<script> 
function RemedyHome() {
var homeurl = "https://servicedeskonline-smartit.onbmc.com/ux/smart-it/#/ticket-console";
window.open(homeurl,'iframe_a');
}
</script>

<div class="sansserif" id="toggleText" style="display: block;background-color:#F2F2F2">
<div class="Table">
<div class="Heading">
    
    <div class="Cell" style="background-color:#F2F2F2; color:black;border: 0px solid rgb(212,223,229);">
        <p><form id="TicketSearch" action="form_action.asp">
        Record Lookup<br>
         <input id="TicketNumber" type="text" name="number">
        </form>
        
        <button onclick="TicketSearch()">Search</button>
        
        <script>
        function TicketSearch(){
            var detail = document.getElementById("TicketNumber").value;
            var smart = "https://servicedeskonline-smartit.onbmc.com/ux/smart-it/#/search/";
            var urlsend = ""
        
urlsend = smart+detail;
          window.open(urlsend,'iframe_a');
        }
        </script>
    </div>

    <div class="Cell" style="background-color:#F2F2F2; color:black;border: 0px solid rgb(212,223,229)">
        <p><form id="CISearch" action="form_action.asp">
        Asset Lookup<br>
         <select id="CI">
          <option value="pcmu">Computer MU</option>
          <option value="pcser">Computer Serial</option>
          <option value="monmu">Monitor MU</option>
          <option value="monser">Monitor Serial</option>
	  <option value="advmu">Advanced</option>
        </select>
        <input id="Number" type="text" name="number">
        </form>
        
        <button onclick="CIDetails()">Search</button>
        
        <script>
        function CIDetails(){
            var ci = document.getElementById("CI").value;
            var detail= document.getElementById("Number").value;
            var urlpcmu = "https://servicedeskonline.onbmc.com/arsys/forms/monash-s/AST%3AComputerSystem/Best+Practice+View/?qual=%27CI+Name%2a%27LIKE%22";
            var urlpcser = "https://servicedeskonline.onbmc.com/arsys/forms/monash-s/AST%3AComputerSystem/Best+Practice+View/?qual=%27Serial+Number%27LIKE%22";
            var urlmonmu = "https://servicedeskonline.onbmc.com/arsys/forms/monash-s/AST%3AMonitor/Best+Practice+View/?qual=%27CI+Name%2a%27LIKE%22";
            var urlmonser = "https://servicedeskonline.onbmc.com/arsys/forms/monash-s/AST%3AMonitor/Best+Practice+View/?qual=%27Serial+Number%27LIKE%22";
	    var urladv = "https://servicedeskonline.onbmc.com/arsys/forms/monash-s/AST%3AAssetAdvancedSearch/Advanced%20Select%20CI/?qual=%27CI+Name%27LIKE%22";
	    
            var urlsend = ""
            var text = "";
        
        detail += "%25%22" + "";
        
        switch(ci) {
            case "pcmu":
              urlsend =  urlpcmu + detail;
              break;
            case "pcser":
              urlsend =  urlpcser + detail;
              break;
            case "monmu":
              urlsend =  urlmonmu + detail;
              break;
            case "monser":
              urlsend =  urlmonser + detail;
              break;
	    case "advmu":
		urlsend = urladv + detail;
		break;
	    default:
              text = "error";
          }
          window.open(urlsend,'iframe_a');
        }
        </script>
    </div>

    <div class="Cell" style="background-color:#F2F2F2; color:black;border: 0px solid rgb(212,223,229)">
        <p><form id="CustomerSearch" action="form_action.asp">
        Customer Lookup<br>
        <select id="Customer">
          <option value="Username">Username</option>
		  <option value="CustTix">Customer Tickets</option>
          <option value="StaffProfile">Staff Profile</option>
		  </select>
        First <input type="text" id="fname" value="">
        Last <input type="text" id="lname" value="">
        </form>
        
        <button onclick="CustLookup()">Search</button>
        
        <script>
        function CustLookup(){
            var TicketType = document.getElementById("Customer").value;
            var FirstName = document.getElementById("fname").value;
			var LastName = document.getElementById("lname").value;
			var urltix = "https://servicedeskonline.onbmc.com/arsys/forms/monash-s/SHR%3ALandingConsole/Default+Administrator+View/?mode=search&F304255500=HPD%3AHelp+Desk&F1000000076=FormOpenNoAppList&F303647600=SearchTicketWithQual&F304255610=%27First+Name%27LIKE%22%25";
            var urlprofile = "https://servicedeskonline.onbmc.com/arsys/forms/monash-s/CTM%3APeople/Default+User+View/?qual=%27First+Name%2a%27LIKE%22";
 			var urlLNProfile = "%25%25%22+AND+%27Last+Name%2a%2B%27LIKE%22";
			var urlstaffprofile = "%25%22+AND+%27Contact+Type%27LIKE%22%25Staff%22";
			var urlLNCustTix = "%25%25%22+AND+%27Last+Name%27LIKE%22%25";
			var usrnamelookup = "https://servicedeskonline-smartit.onbmc.com/ux/smart-it/#/person/";
			var urlsend = "";
            var text = "";
            var detail = "%25%22";
        
        switch(TicketType) {
            case "CustTix":
              urlsend =  urltix + FirstName + urlLNCustTix + LastName + detail;
              break;
            case "StaffProfile":
              urlsend =  urlprofile + FirstName + urlLNProfile + LastName + urlstaffprofile;
              break;
	    case "Username":
	      urlsend = usrnamelookup + FirstName;
	      break;
          }          
          window.open(urlsend,'iframe_a');
        }
        </script>
    </div>

</div>
</div>  
</div>

    <div>
    <iframe name="iframe_a" style="position: absolute; width: 99%; height:99%; border: none"></iframe>
    </div>
    
</body>
